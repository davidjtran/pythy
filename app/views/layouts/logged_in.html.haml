!!!
%html
  %head
    %title Pythy
    = stylesheet_link_tag "application", :media => "all"
    = javascript_include_tag "application"
    = csrf_meta_tags
    = favicon_link_tag
  %body
    .navbar.navbar-inverse.navbar-fixed-top
      .navbar-inner
        .container
          = link_to 'Pythy', root_url, :class => 'brand'
          %ul.nav
            - unless current_user.course_enrollments.blank?
              %li.dropdown
                = dropdown_tag do
                  %i.icon-caret-down
                  %span
                    CS 000
                %ul.dropdown-menu
                  %li.nav-header 
                    CS 000 Settings
                  %li
                    %a{:href => "#"} Edit course
                  %li
                    %a{:href => "#"} Manage assignments
                  %li.nav-header Select a different course 
                  - current_user.course_offerings.each do |course|
                    %li.active
                      %a{:href => "#"}
                        %strong CS
                        = course.course_id
                        - 
                        = course.label
                  / %li.active
                  /   %a{:href => "#"}
                  /     %strong CS 1024 - 
                  /     Intro to COBOL 
            = nav_item_tag :home do
              %i.icon-home.icon-large
              %span.hidden-phone Home
            - unless current_user.course_enrollments.blank?
              = nav_item_tag :code do
                %i.icon-edit.icon-large
                %span.hidden-phone Code
              = nav_item_tag :code do
                %i.icon-bar-chart.icon-large
                %span.hidden-phone Grade 
              = nav_item_tag :code do
                %i.icon-bar-chart.icon-large
                %span.hidden-phone View 
              / %li
              /   %a{:href => "#contact"}
              /     %i.icon-book.icon-large
              /     %span.hidden-phone Textbook
          %ul.nav.pull-right
            / FIXME this menu should disappear if no permissions are met (pending figuring
            / out the best way to replace that similarly-functioning if statement below)
            %li.dropdown          
              = dropdown_tag do
                %i.icon-wrench.icon-large
                %i.icon-caret-down
              %ul.dropdown-menu
                / FIXME this giant if statement is kinda ugly
                - if can? :manage, User or can? :manage, GlobalRole or can? :manage, CourseRole or can? :manage, Institution
                  %li.nav-header Configure
                  - if can? :manage, User 
                    %li
                      = link_to 'Users', users_path
                  - if can? :manage, GlobalRole
                    %li
                      = link_to 'Global roles', global_roles_path 
                  - if can? :manage, CourseRole
                    %li
                      = link_to 'Course-specific roles', course_roles_path
                  - if can? :manage, Institution
                    %li
                      = link_to 'Institutions', institutions_path 
                %li.nav-header Manage 
                - if can? :manage, CourseOffering
                  %li
                    = link_to 'Course offerings', course_offerings_path
            %li.dropdown
              = dropdown_tag do
                %i.icon-user.icon-large
                %span.hidden-phone
                  = current_user.email
                %i.icon-caret-down
                %ul.dropdown-menu
                  %li
                    %a{:href => "#"}
                      %i.icon-cog
                      Account settings 
                  %li.divider
                  %li
                    = link_to destroy_user_session_path, :method => :delete do
                      %i.icon-signout
                      Sign out 
    #main-container.container
      #main-container-inner
        = yield

